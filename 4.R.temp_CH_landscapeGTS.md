#Fine scale connectivity or Rana temporaria at different spatial scales


Question: what determines connectivity between populations across different spatial scales? 
- same environmental gradient
- Very different landscapes

Important paper on the use of Mantel tests in spatial analyses: Don't!

Legendre et al. 2015 (Mehods in Ecology and Evolution)

http://onlinelibrary.wiley.com/doi/10.1111/2041-210X.12425/epdf

I'm interested in the at-site and between-site variables that could determine connectivity between populations. 

###Part 1. Connectivity will be determined by at and between site variables, rather than absolute distance. For between site, I hypothesise that topographic complexity with create increased resistance to geneflow. 
a) At site, I hypothesise that site quality i.t.o pond size, and climate i.t.o developmental degree days, will explain migration between ponds. 


###Part 2. Does this hold true at different spatial scales?

Compare Gravity model across all data vs within Structure groups. 

- CHall

- CHS
  CHS.TI
  CHS.VS
 
- CHN

- CZ
 
Major barriers to dispersal? Ridges? How will I define this? 
Monmoniers algorithm 

###Part 3. Can I identify the range edge? I hypothesis that the range edge is determined by limited developmental time for the tadpoles. ie. duration of snow cover (snow free days), or developmental degree days. 

#####Part 1: Gravity Model

As implemented in Murphy et al. 2010. 

They've just released an R package: GeNetIt

https://cran.r-project.org/web/packages/GeNetIt/GeNetIt.pdf

1. Build a network of all connections 

2. Test the best fit model (i.e. which variables best describe the genetic distance)

3. Compare to a smaller network (e.g. 10km - double the dispersal distance of R.temp=


Building the network in R
```
library(sp)

setwd("/Users/alexjvr/2016RADAnalysis/3_LandscapeGenetics/")

rtemp_sites <- read.csv("rtemp_sites.csv", header=T)

xy <- cbind(rtemp_site$lat, rtemp_site$long)  ##create a df with only the coordinates

pts <- SpatialPoints(xy)  ##turns them into spatial points for sp

Rtemp.Spatial <- SpatialPointsDataFrame(pts, rtemp_site)  ##create a SpatialPointsDF. This is needed to create the network below. 


###Creating the network
library(GeNetIt)

sat.graph.rtemp <- knn.graph(Rtemp.Spatial, row.names=Rtemp.Spatial@data[,"site"], long.lat=T) #saturated graph
graph.rtemp.10km <- knn.graph(Rtemp.Spatial, row.names=Rtemp.Spatial@data[,"site"], long.lat=T, max.dist=10)  ##long.lat=T for decimal degrees. 

##plot
par(mfrow=c(3,2)) ##creates box for two plots. c(3,2) means 3 rows, 2 columns

plot(sat.graph.rtemp.30km, col="grey")
points(Rtemp.Spatial, co="red", pch=20, cex=0.5)
box()
title("30km dist contrained")

plot(sat.graph.rtemp, col="grey")
points(Rtemp.Spatial, co="red", pch=20, cex=0.5)
box()
title("Saturated graph")

```

![alt_txt][Sat.graphs]
[Sat.graphs]:https://cloud.githubusercontent.com/assets/12142475/19343990/c140a4f2-9138-11e6-818f-c078e047b125.png



